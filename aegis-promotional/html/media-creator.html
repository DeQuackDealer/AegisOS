<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aegis OS Media Creation Tool</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.98);
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .main-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .creator-card {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .step {
            margin: 2rem 0;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .step-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .step-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }

        .edition-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .edition-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .edition-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .edition-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
        }

        .edition-card.selected::after {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .edition-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .edition-price {
            color: #667eea;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .edition-desc {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .edition-size {
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px solid #e0e0e0;
            color: #999;
            font-size: 0.85rem;
        }

        .options-section {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .option-row {
            display: flex;
            align-items: center;
            margin: 1rem 0;
        }

        .option-row input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 1rem;
        }

        .option-label {
            flex: 1;
        }

        .option-name {
            font-weight: 600;
            color: #333;
        }

        .option-desc {
            color: #666;
            font-size: 0.9rem;
        }

        .progress-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            display: none;
        }

        .progress-section.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .progress-status {
            text-align: center;
            color: #666;
            margin-top: 1rem;
        }

        .btn {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            margin: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #666;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .download-link {
            display: none;
            text-align: center;
            margin-top: 2rem;
            padding: 1.5rem;
            background: #e8f5e9;
            border-radius: 12px;
            border: 2px solid #4caf50;
        }

        .download-link.active {
            display: block;
        }

        .download-link a {
            color: #2e7d32;
            font-weight: 600;
            text-decoration: none;
            font-size: 1.1rem;
        }

        .requirements {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .requirements h4 {
            color: #856404;
            margin-bottom: 0.5rem;
        }

        .requirements ul {
            margin-left: 1.5rem;
            color: #856404;
        }

        .disclaimer {
            background: #f8d7da;
            color: #721c24;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 2rem;
            font-size: 0.9rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo">üõ°Ô∏è Aegis OS</a>
        </div>
    </header>

    <main class="main-container">
        <div class="creator-card">
            <h1>üöÄ Aegis Media Creation Tool (Technical Preview)</h1>
            <p class="subtitle">Experience how Aegis OS ISO building will work</p>
            
            <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                <strong style="color: #d97706;">‚ö†Ô∏è Technical Preview:</strong>
                <span style="color: #92400e;">This is a demonstration of the Aegis OS Media Creation Tool. 
                The generated ISOs are for evaluation purposes and are not production bootable images. 
                Full production ISOs with genuine Linux builds will be available in the future release.</span>
            </div>

            <div class="step">
                <div class="step-header">
                    <span class="step-number">1</span>
                    <span class="step-title">Choose Your Edition</span>
                </div>
                
                <div class="edition-grid">
                    <div class="edition-card" data-edition="freemium" onclick="selectEdition('freemium')">
                        <div class="edition-name">Freemium</div>
                        <div class="edition-price">FREE</div>
                        <div class="edition-desc">Basic Linux with XFCE desktop</div>
                        <div class="edition-size">ISO Size: ~1.5 GB</div>
                    </div>
                    
                    <div class="edition-card" data-edition="basic" onclick="selectEdition('basic')">
                        <div class="edition-name">Basic</div>
                        <div class="edition-price">$69</div>
                        <div class="edition-desc">500+ professional apps</div>
                        <div class="edition-size">ISO Size: ~3.5 GB</div>
                    </div>
                    
                    <div class="edition-card" data-edition="gamer" onclick="selectEdition('gamer')">
                        <div class="edition-name">Gamer</div>
                        <div class="edition-price">$89</div>
                        <div class="edition-desc">Gaming optimized + Wine</div>
                        <div class="edition-size">ISO Size: ~4.5 GB</div>
                    </div>
                    
                    <div class="edition-card" data-edition="ai" onclick="selectEdition('ai')">
                        <div class="edition-name">AI Developer</div>
                        <div class="edition-price">$109</div>
                        <div class="edition-desc">ML frameworks + CUDA</div>
                        <div class="edition-size">ISO Size: ~6.0 GB</div>
                    </div>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <span class="step-number">2</span>
                    <span class="step-title">Customize Options</span>
                </div>
                
                <div class="options-section">
                    <div class="option-row">
                        <input type="checkbox" id="updates" checked>
                        <label for="updates" class="option-label">
                            <div class="option-name">Include Latest Updates</div>
                            <div class="option-desc">Download and include the latest security patches and updates</div>
                        </label>
                    </div>
                    
                    <div class="option-row">
                        <input type="checkbox" id="drivers" checked>
                        <label for="drivers" class="option-label">
                            <div class="option-name">Proprietary Drivers</div>
                            <div class="option-desc">Include NVIDIA/AMD proprietary drivers for better performance</div>
                        </label>
                    </div>
                    
                    <div class="option-row">
                        <input type="checkbox" id="codecs" checked>
                        <label for="codecs" class="option-label">
                            <div class="option-name">Media Codecs</div>
                            <div class="option-desc">Include multimedia codecs for playing videos and music</div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <span class="step-number">3</span>
                    <span class="step-title">Build Your ISO</span>
                </div>
                
                <div class="requirements">
                    <h4>‚ö†Ô∏è System Requirements:</h4>
                    <ul>
                        <li>8-16 GB free disk space</li>
                        <li>Stable internet connection</li>
                        <li>Windows 10/11, macOS, or Linux</li>
                        <li>Build time: 10-30 minutes depending on connection</li>
                    </ul>
                </div>

                <div class="progress-section" id="progressSection">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
                    </div>
                    <div class="progress-status" id="progressStatus">Initializing build system...</div>
                </div>

                <div class="download-link" id="downloadSection">
                    <h3>‚úÖ ISO Ready!</h3>
                    <p>Your Aegis OS ISO has been created successfully.</p>
                    <a href="#" id="downloadLink">üì• Download ISO (Click to Save)</a>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="downloadBuilder()">
                        üì• Download USB Creator (Windows .exe)
                    </button>
                    <button class="btn" id="buildBtn" onclick="startBuild()" disabled>
                        üî® Build ISO Now (Web Version)
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 1rem; color: #6b7280; font-size: 0.9rem;">
                    <strong>Windows Users:</strong> Download the USB Creator for one-click installation<br>
                    <strong>Mac/Linux Users:</strong> Use the web builder above or download the script
                </div>
            </div>

            <div class="disclaimer">
                <strong>‚ö†Ô∏è Disclaimer:</strong> Anything represented on this page may not be true. Use at your own risk. 
                Build times and ISO sizes are estimates and may vary based on your system and internet connection.
            </div>
        </div>
    </main>

    <script>
        let selectedEdition = null;
        let isBuilding = false;

        function selectEdition(edition) {
            selectedEdition = edition;
            
            // Update UI
            document.querySelectorAll('.edition-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-edition="${edition}"]`).classList.add('selected');
            
            // Enable build button
            document.getElementById('buildBtn').disabled = false;
            document.getElementById('buildBtn').textContent = `üî® Build ${edition.charAt(0).toUpperCase() + edition.slice(1)} ISO`;
        }

        function downloadBuilder() {
            // Windows users get the USB Creator
            if (navigator.platform.indexOf('Win') > -1) {
                window.location.href = '/download-usb-creator';
            } else {
                // Mac/Linux users get script
                const builderScript = generateBuilderScript(); 
                const blob = new Blob([builderScript], { type: 'text/x-shellscript' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'aegis-media-creator.sh';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }
        }

        function generateBuilderScript() {
            const edition = selectedEdition || 'freemium';
            return `#!/bin/bash
# Aegis OS Media Creation Tool
# Builds custom ISO for ${edition} edition

set -e

echo "================================"
echo "  AEGIS OS MEDIA CREATOR"
echo "  Edition: ${edition.toUpperCase()}"
echo "================================"
echo ""

# Check system
if [[ "$OSTYPE" == "linux-gnu"* ]]; then
    SYSTEM="linux"
elif [[ "$OSTYPE" == "darwin"* ]]; then
    SYSTEM="macos"
elif [[ "$OSTYPE" == "msys" || "$OSTYPE" == "cygwin" ]]; then
    SYSTEM="windows"
else
    echo "Unsupported system: $OSTYPE"
    exit 1
fi

echo "[1/5] Checking dependencies..."
sleep 1

echo "[2/5] Downloading base system..."
echo "  ‚Üí Fetching Ubuntu 22.04 base..."
# wget https://aegis-os.com/base/ubuntu-base.tar.gz
sleep 2

echo "[3/5] Installing packages for ${edition}..."
case "${edition}" in
    freemium)
        echo "  ‚Üí Installing XFCE desktop"
        echo "  ‚Üí Installing basic applications"
        PACKAGES=50
        ;;
    basic)
        echo "  ‚Üí Installing 500+ professional applications"
        echo "  ‚Üí Installing development tools"
        PACKAGES=500
        ;;
    gamer)
        echo "  ‚Üí Installing gaming platforms"
        echo "  ‚Üí Installing Wine/Proton"
        PACKAGES=550
        ;;
    ai)
        echo "  ‚Üí Installing ML frameworks"
        echo "  ‚Üí Installing CUDA toolkit"
        PACKAGES=600
        ;;
esac
sleep 3

echo "[4/5] Building filesystem..."
echo "  ‚Üí Creating squashfs..."
sleep 2

echo "[5/5] Generating ISO..."
echo "  ‚Üí Creating bootable image..."
sleep 2

echo ""
echo "================================"
echo "  BUILD COMPLETE!"
echo "  ISO: aegis-${edition}.iso"
echo "  Size: $(du -h aegis-${edition}.iso 2>/dev/null || echo '~3.5GB')"
echo "================================"
echo ""
echo "You can now burn this ISO to USB using:"
echo "  - Rufus (Windows)"
echo "  - balenaEtcher (All platforms)"
echo "  - dd command (Linux/Mac)"
`;
        }

        function startBuild() {
            if (!selectedEdition) {
                alert('Please select an edition first');
                return;
            }
            
            // Only Freemium is free
            if (selectedEdition !== 'freemium') {
                const key = prompt('This edition requires a license key.\nEnter your license key (XXXX-XXXX-XXXX-XXXX):');
                if (!key || !validateLicenseKey(key, selectedEdition)) {
                    alert('Invalid or missing license key!\n\nPurchase a license at https://aegis-os.com\n\nOnly Freemium edition is free.');
                    isBuilding = false;
                    return;
                }
            }
            
            if (isBuilding) return;
            isBuilding = true;
            
            // Show progress section
            document.getElementById('progressSection').classList.add('active');
            document.getElementById('buildBtn').disabled = true;
            document.getElementById('buildBtn').textContent = '‚è≥ Building...';
            
            // Simulate build process
            let progress = 0;
            const stages = [
                { progress: 10, status: 'Checking system requirements...' },
                { progress: 20, status: 'Downloading base system components...' },
                { progress: 40, status: `Installing ${selectedEdition} packages...` },
                { progress: 60, status: 'Configuring system settings...' },
                { progress: 80, status: 'Creating bootable ISO...' },
                { progress: 95, status: 'Finalizing image...' },
                { progress: 100, status: 'Build complete!' }
            ];
            
            let stageIndex = 0;
            const interval = setInterval(() => {
                if (stageIndex < stages.length) {
                    const stage = stages[stageIndex];
                    updateProgress(stage.progress, stage.status);
                    stageIndex++;
                } else {
                    clearInterval(interval);
                    onBuildComplete();
                }
            }, 2000);
        }

        function updateProgress(percent, status) {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressBar').textContent = percent + '%';
            document.getElementById('progressStatus').textContent = status;
        }

        function onBuildComplete() {
            // Show download section
            document.getElementById('downloadSection').classList.add('active');
            
            // Create download link
            const isoData = `Aegis OS ${selectedEdition} ISO - Ready for installation`;
            const blob = new Blob([isoData], { type: 'application/octet-stream' });
            const url = window.URL.createObjectURL(blob);
            const link = document.getElementById('downloadLink');
            link.href = url;
            link.download = `aegis-${selectedEdition}.iso`;
            
            // Update button
            document.getElementById('buildBtn').textContent = '‚úÖ Build Complete';
        }

        function validateLicenseKey(key, edition) {
            // License key validation
            const prefixes = {
                'basic': 'BSIC',
                'gamer': 'GAME',
                'ai': 'AIDV',
                'server': 'SERV'
            };
            
            // Check format
            if (!key.match(/^[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/)) {
                return false;
            }
            
            // Check prefix
            if (prefixes[edition] && !key.startsWith(prefixes[edition])) {
                return false;
            }
            
            return true;
        }

        // Auto-select freemium on load
        window.addEventListener('load', () => {
            selectEdition('freemium');
        });
    </script>
</body>
</html>