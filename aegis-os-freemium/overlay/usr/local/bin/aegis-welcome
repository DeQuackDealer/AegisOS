
#!/usr/bin/env python3
"""
Aegis OS Welcome Application - Freemium Edition
Displays welcome information and setup options
"""

import subprocess
import os
import sys

# Try to import tkinter
try:
    import tkinter as tk
    from tkinter import ttk, messagebox
    import webbrowser
    TKINTER_AVAILABLE = True
except ImportError:
    TKINTER_AVAILABLE = False

class AegisWelcome:
    def __init__(self):
        self.root = tk.Tk()
        self.setup_window()
        self.create_widgets()
        
    def setup_window(self):
        """Configure the main window"""
        self.root.title("Welcome to Aegis OS Freemium")
        self.root.geometry("800x600")
        self.root.resizable(False, False)
        
        # Center the window
        self.root.update_idletasks()
        x = (self.root.winfo_screenwidth() // 2) - (800 // 2)
        y = (self.root.winfo_screenheight() // 2) - (600 // 2)
        self.root.geometry(f"800x600+{x}+{y}")
        
    def create_widgets(self):
        """Create and arrange GUI widgets"""
        # Header
        header_frame = ttk.Frame(self.root)
        header_frame.pack(fill="x", padx=20, pady=20)
        
        title_label = ttk.Label(
            header_frame, 
            text="Welcome to Aegis OS", 
            font=("Arial", 24, "bold")
        )
        title_label.pack()
        
        subtitle_label = ttk.Label(
            header_frame,
            text="Freemium Edition - The Gaming-Ready Linux Distribution",
            font=("Arial", 14)
        )
        subtitle_label.pack(pady=(5, 0))
        
        # Features section
        features_frame = ttk.LabelFrame(self.root, text="What's Included", padding=15)
        features_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        features = [
            "ğŸ§ Linux-based foundation for stability and security",
            "ğŸ® Proton and Wine pre-configured for Windows game compatibility",
            "âš¡ Lightweight XFCE desktop environment",
            "ğŸ”§ Essential system utilities and optimization tools",
            "ğŸ‘¥ Community support and forums access",
            "ğŸ†“ Completely free with no hidden costs"
        ]
        
        for feature in features:
            feature_label = ttk.Label(features_frame, text=feature, font=("Arial", 11))
            feature_label.pack(anchor="w", pady=2)
        
        # Actions section
        actions_frame = ttk.LabelFrame(self.root, text="Get Started", padding=15)
        actions_frame.pack(fill="x", padx=20, pady=10)
        
        # Buttons
        button_frame = ttk.Frame(actions_frame)
        button_frame.pack(fill="x", pady=10)
        
        system_info_btn = ttk.Button(
            button_frame,
            text="System Information",
            command=self.show_system_info
        )
        system_info_btn.pack(side="left", padx=(0, 10))
        
        gaming_setup_btn = ttk.Button(
            button_frame,
            text="Gaming Setup",
            command=self.launch_gaming_setup
        )
        gaming_setup_btn.pack(side="left", padx=10)
        
        community_btn = ttk.Button(
            button_frame,
            text="Join Community",
            command=self.open_community
        )
        community_btn.pack(side="left", padx=10)
        
        # Upgrade section
        upgrade_frame = ttk.LabelFrame(self.root, text="Ready to Upgrade?", padding=15)
        upgrade_frame.pack(fill="x", padx=20, pady=10)
        
        upgrade_text = ttk.Label(
            upgrade_frame,
            text="Get priority security updates, professional support, and advanced features",
            font=("Arial", 10)
        )
        upgrade_text.pack()
        
        upgrade_btn = ttk.Button(
            upgrade_frame,
            text="View Paid Editions",
            command=self.open_upgrade_info
        )
        upgrade_btn.pack(pady=(10, 0))
        
        # Close button
        close_btn = ttk.Button(
            self.root,
            text="Close",
            command=self.root.destroy
        )
        close_btn.pack(pady=20)
        
        # Don't show again checkbox
        self.show_again_var = tk.BooleanVar(value=True)
        show_again_cb = ttk.Checkbutton(
            self.root,
            text="Show this welcome screen on startup",
            variable=self.show_again_var,
            command=self.toggle_autostart
        )
        show_again_cb.pack()
        
    def show_system_info(self):
        """Display system information"""
        try:
            result = subprocess.run(["/usr/local/bin/aegis-system-info"], 
                                  capture_output=True, text=True)
            
            # Create a new window for system info
            info_window = tk.Toplevel(self.root)
            info_window.title("Aegis OS System Information")
            info_window.geometry("600x500")
            
            text_widget = tk.Text(info_window, font=("Courier", 10))
            text_widget.pack(fill="both", expand=True, padx=10, pady=10)
            
            scrollbar = ttk.Scrollbar(text_widget)
            scrollbar.pack(side="right", fill="y")
            text_widget.config(yscrollcommand=scrollbar.set)
            scrollbar.config(command=text_widget.yview)
            
            text_widget.insert("1.0", result.stdout)
            text_widget.config(state="disabled")
            
        except Exception as e:
            messagebox.showerror("Error", f"Failed to get system information: {e}")
    
    def launch_gaming_setup(self):
        """Launch gaming optimization setup"""
        try:
            subprocess.run(["/usr/local/bin/aegis-gaming-optimizer"], check=True)
            messagebox.showinfo("Success", "Gaming optimizations have been applied!")
        except Exception as e:
            messagebox.showerror("Error", f"Gaming setup failed: {e}")
    
    def open_community(self):
        """Open community forums"""
        webbrowser.open("https://community.aegis-os.com")
    
    def open_upgrade_info(self):
        """Open upgrade information"""
        webbrowser.open("https://aegis-os.com/editions")
    
    def toggle_autostart(self):
        """Toggle welcome screen autostart"""
        autostart_dir = "/home/aegis/.config/autostart"
        autostart_file = os.path.join(autostart_dir, "aegis-welcome.desktop")
        
        if self.show_again_var.get():
            # Enable autostart
            os.makedirs(autostart_dir, exist_ok=True)
            desktop_content = """[Desktop Entry]
Type=Application
Name=Aegis Welcome
Exec=/usr/local/bin/aegis-welcome
Hidden=false
NoDisplay=false
X-GNOME-Autostart-enabled=true
"""
            with open(autostart_file, 'w') as f:
                f.write(desktop_content)
        else:
            # Disable autostart
            if os.path.exists(autostart_file):
                os.remove(autostart_file)
    
    def run(self):
        """Run the welcome application"""
        self.root.mainloop()

def show_cli_welcome():
    """Display welcome message in CLI when tkinter is not available"""
    print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   WELCOME TO AEGIS OS                         â•‘
â•‘                    Freemium Edition                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â–„â–€â–ˆ â–ˆâ–€â–€ â–ˆâ–€â–€ â–ˆ â–ˆâ–€   â–ˆâ–€â–ˆ â–ˆâ–€
    â–ˆâ–€â–ˆ â–ˆâ–ˆâ–„ â–ˆâ–„â–ˆ â–ˆ â–„â–ˆ   â–ˆâ–„â–ˆ â–„â–ˆ
    
The Gold Standard for Gaming

WHAT'S INCLUDED:
âœ… Linux-based foundation for stability and security
âœ… Proton and Wine pre-configured for Windows game compatibility
âœ… Lightweight XFCE desktop environment
âœ… Essential system utilities and optimization tools
âœ… Community support and forums access
âœ… Completely free with no hidden costs

QUICK START COMMANDS:
â€¢ System Information : aegis-system-info
â€¢ Gaming Optimizer   : aegis-gaming-optimizer
â€¢ System Monitor     : aegis-system-monitor
â€¢ License Manager    : aegis-license-manager

COMMUNITY & SUPPORT:
â€¢ Forums    : https://community.aegis-os.com
â€¢ Wiki      : https://wiki.aegis-os.com
â€¢ Upgrades  : https://aegis-os.com/editions

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’ Ready to unlock full potential? Visit aegis-os.com for Pro editions!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
""")

if __name__ == "__main__":
    if TKINTER_AVAILABLE:
        try:
            app = AegisWelcome()
            app.run()
        except Exception as e:
            print(f"GUI failed: {e}")
            show_cli_welcome()
    else:
        show_cli_welcome()
