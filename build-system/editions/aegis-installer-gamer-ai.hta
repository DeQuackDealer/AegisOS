<html>
<head>
<title>Aegis OS Gamer+AI Edition Installer</title>
<HTA:APPLICATION ID="AegisGamerAIInstaller" APPLICATIONNAME="Aegis OS Gamer+AI Edition Installer" BORDER="thick" BORDERSTYLE="normal" CAPTION="yes" MAXIMIZEBUTTON="no" MINIMIZEBUTTON="yes" SHOWINTASKBAR="yes" SINGLEINSTANCE="yes" SYSMENU="yes" VERSION="3.0" SCROLL="no" INNERBORDER="no"/>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #fff; height: 100vh; overflow: hidden; margin: 0; }
.wizard { display: flex; flex-direction: column; height: 100vh; }
.wizard-header { flex-shrink: 0; background: linear-gradient(135deg, #c026d3 0%, #a21caf 100%); padding: 8px 12px; display: flex; align-items: center; gap: 8px; }
.logo-svg { width: 36px; height: 36px; }
.shield-animate { animation: shieldPulse 2s ease-in-out infinite; }
@keyframes shieldPulse { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 3px rgba(217, 70, 239, 0.5)); } 50% { transform: scale(1.05); filter: drop-shadow(0 0 8px rgba(217, 70, 239, 0.8)); } }
.header-text h1 { font-size: 14px; font-weight: 600; }
.header-text p { font-size: 10px; opacity: 0.9; }
.wizard-breadcrumb { flex-shrink: 0; display: flex; justify-content: space-between; gap: 4px; padding: 4px 12px; background: #12122a; border-bottom: 1px solid #1f2a40; }
.step-crumb { flex: 1; text-align: center; font-size: 9px; padding: 5px 3px; border-radius: 4px; background: #1a2438; color: #8ca0c8; }
.step-crumb.active { background: linear-gradient(135deg, #c026d3, #d946ef); color: #fff; font-weight: 600; }
.step-crumb.done { background: #0f1d33; color: #d946ef; }
.wizard-content { flex: 1; overflow: hidden; position: relative; min-height: 0; }
.slide { display: none; padding: 8px 12px; height: 100%; overflow: hidden; }
.slide.active { display: flex; flex-direction: column; }
.wizard-footer { flex-shrink: 0; padding: 8px 12px; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #333; background: #12122a; }
.section-title { font-size: 13px; font-weight: 600; margin-bottom: 3px; }
.section-desc { font-size: 10px; color: #b0b0b0; margin-bottom: 6px; }
.info-box { background: rgba(192, 38, 211, 0.15); border: 1px solid rgba(192, 38, 211, 0.3); border-radius: 5px; padding: 6px; margin-bottom: 6px; }
.info-box h3 { font-size: 10px; margin-bottom: 4px; color: #d946ef; }
.info-box ul { font-size: 9px; color: #b0b0b0; padding-left: 14px; margin: 0; }
.drive-list { background: #1e1e3a; border: 1px solid #333; border-radius: 5px; max-height: 80px; overflow-y: auto; margin-bottom: 6px; }
.drive-item { padding: 6px 8px; border-bottom: 1px solid #333; cursor: pointer; display: flex; align-items: center; gap: 8px; }
.drive-item:last-child { border-bottom: none; }
.drive-item:hover { background: #2a2a4a; }
.drive-item.selected { background: rgba(192, 38, 211, 0.3); border-left: 3px solid #d946ef; }
.drive-icon { width: 24px; height: 24px; background: linear-gradient(135deg, #c026d3, #d946ef); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 8px; font-weight: bold; }
.drive-info { flex: 1; }
.drive-name { font-weight: 500; font-size: 11px; }
.drive-size { font-size: 9px; color: #b0b0b0; }
.no-drives { padding: 15px; text-align: center; color: #888; font-size: 10px; }
.btn { padding: 8px 16px; border-radius: 5px; font-weight: 600; cursor: pointer; border: none; font-size: 11px; transition: all 0.2s; }
.btn-primary { background: linear-gradient(135deg, #c026d3, #d946ef); color: white; }
.btn-primary:hover { transform: translateY(-1px); box-shadow: 0 3px 12px rgba(192, 38, 211, 0.4); }
.btn-primary:disabled { background: #444; cursor: not-allowed; }
.btn-secondary { background: #2a2a4a; color: #aaa; border: 1px solid #444; }
.btn-refresh { background: #1e1e3a; color: #d946ef; padding: 4px 8px; font-size: 9px; }
.btn-small { padding: 3px 8px; font-size: 9px; }
.btn-create { background: linear-gradient(135deg, #16a34a, #22c55e); padding: 10px 24px; font-size: 12px; }
.progress-container { background: #1e1e3a; border-radius: 5px; padding: 12px; text-align: center; }
.progress-bar-bg { height: 8px; background: #2a2a4a; border-radius: 4px; overflow: hidden; margin: 10px 0; }
.progress-bar-fill { height: 100%; background: linear-gradient(90deg, #c026d3, #d946ef, #c026d3); background-size: 200% 100%; width: 0%; transition: width 0.5s; border-radius: 4px; }
.progress-bar-fill.animated { animation: shimmer 1.5s infinite linear; }
@keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
.progress-percent { font-size: 24px; font-weight: 700; color: #d946ef; }
.progress-status { font-size: 11px; color: #aaa; margin-top: 4px; }
.progress-detail { font-size: 9px; color: #a0a0a0; margin-top: 2px; }
.success-container { text-align: center; padding: 10px; }
.success-icon { font-size: 32px; margin-bottom: 8px; color: #10b981; }
.success-title { font-size: 16px; color: #10b981; margin-bottom: 4px; }
.success-desc { font-size: 11px; color: #aaa; }
.success-steps { background: #1e1e3a; border-radius: 5px; padding: 10px; margin-top: 10px; text-align: left; }
.success-steps h3 { font-size: 11px; margin-bottom: 6px; }
.success-steps ol { padding-left: 14px; font-size: 10px; color: #aaa; margin: 0; }
.error-box { background: rgba(239, 68, 68, 0.15); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 5px; padding: 8px; color: #f87171; font-size: 11px; }
.warning-box { background: rgba(192, 38, 211, 0.15); border: 1px solid rgba(192, 38, 211, 0.3); border-radius: 5px; padding: 8px; margin-bottom: 8px; font-size: 10px; }
.warning-box strong { color: #e879f9; }
.sys-req-box { background: #1e1e3a; border: 1px solid #333; border-radius: 5px; padding: 8px; margin-bottom: 8px; }
.sys-req-item { display: flex; align-items: center; gap: 6px; padding: 2px 0; font-size: 10px; }
.sys-req-pass { color: #10b981; }
.sys-req-warn { color: #d946ef; }
.option-group { margin-bottom: 8px; }
.option-label { font-size: 10px; color: #aaa; margin-bottom: 4px; display: block; }
.radio-group { display: flex; gap: 12px; }
.radio-item { display: flex; align-items: center; gap: 4px; font-size: 10px; cursor: pointer; }
.radio-item input { accent-color: #d946ef; }
.checkbox-item { display: flex; align-items: center; gap: 5px; font-size: 10px; cursor: pointer; }
.checkbox-item input { accent-color: #d946ef; width: 12px; height: 12px; }
.edition-badge { display: inline-block; background: linear-gradient(135deg, #c026d3, #d946ef); padding: 2px 6px; border-radius: 8px; font-size: 9px; font-weight: 600; }
.feature-section { margin-bottom: 6px; }
.feature-section-title { font-size: 10px; color: #d946ef; margin-bottom: 4px; }
.core-features { background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 5px; padding: 6px; margin-bottom: 6px; }
.core-feature-item { display: flex; align-items: center; gap: 5px; padding: 2px 0; font-size: 9px; color: #aaa; }
.core-feature-item .icon { color: #10b981; font-size: 10px; }
.optional-features { background: #1e1e3a; border: 1px solid #333; border-radius: 5px; padding: 6px; max-height: 60px; overflow-y: auto; flex: 1; }
.feature-card { display: flex; align-items: flex-start; gap: 6px; padding: 4px; border-bottom: 1px solid #333; }
.feature-card:last-child { border-bottom: none; }
.feature-card:hover { background: rgba(192, 38, 211, 0.1); }
.feature-card input { accent-color: #d946ef; width: 12px; height: 12px; }
.feature-card-content { flex: 1; }
.feature-card-name { font-size: 10px; font-weight: 500; color: #fff; }
.feature-card-desc { font-size: 8px; color: #b0b0b0; }
.feature-actions { display: flex; gap: 4px; margin-bottom: 4px; }
.feature-count { font-size: 9px; color: #888; margin-top: 4px; }
.confirm-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
.confirm-item { background: #1e1e3a; border-radius: 5px; padding: 8px; }
.confirm-label { font-size: 9px; color: #888; margin-bottom: 2px; }
.confirm-value { font-size: 11px; color: #d946ef; font-weight: 500; }
.hidden { display: none !important; }
</style>
<script language="VBScript">
Const EDITION = "gamer_ai"
Const EDITION_NAME = "Gamer+AI"
Dim selectedDrive, selectedDriveNumber, drives(), driveCount, progressTimer, shell, fso, wmi
Dim smoothProgress, partitionStyle, quickFormat, sysReqPassed, selectedFeatures, currentStep

Sub Window_OnLoad()
    window.resizeTo 720, 640
    Set shell = CreateObject("WScript.Shell"): Set fso = CreateObject("Scripting.FileSystemObject")
    smoothProgress = 0: partitionStyle = "GPT": quickFormat = True: sysReqPassed = False
    selectedFeatures = "gaming,ai_toolkit,stream,fps_boost": currentStep = 1
    CheckSystemRequirements(): UpdateFooterButtons()
End Sub

Sub CheckSystemRequirements()
    Dim ramGB, freeSpaceGB
    On Error Resume Next
    Set wmi = GetObject("winmgmts:\\.\root\cimv2"): ramGB = 0: freeSpaceGB = 0
    For Each mem In wmi.ExecQuery("SELECT TotalPhysicalMemory FROM Win32_ComputerSystem"): ramGB = Round(mem.TotalPhysicalMemory / 1073741824, 1): Next
    Set drv = fso.GetDrive(fso.GetDriveName(shell.ExpandEnvironmentStrings("%TEMP%")))
    If Not drv Is Nothing Then freeSpaceGB = Round(drv.FreeSpace / 1073741824, 1)
    On Error Goto 0
    Dim html: html = "<div class='sys-req-item'><span class='sys-req-pass'>&#10003;</span> RAM: " & ramGB & " GB</div>"
    html = html & "<div class='sys-req-item'><span class='" & IIf(freeSpaceGB >= 5, "sys-req-pass", "sys-req-warn") & "'>" & IIf(freeSpaceGB >= 5, "&#10003;", "&#9888;") & "</span> Space: " & freeSpaceGB & " GB</div>"
    document.getElementById("sysReqContent").innerHTML = html
    sysReqPassed = (freeSpaceGB >= 5)
End Sub

Sub ToggleFeature(f): UpdateFeatures(): End Sub
Sub SelectAllFeatures(): Dim c, i: Set c = document.querySelectorAll(".optional-features input"): For i = 0 To c.length - 1: c(i).checked = True: Next: UpdateFeatures(): End Sub
Sub DeselectAllFeatures(): Dim c, i: Set c = document.querySelectorAll(".optional-features input"): For i = 0 To c.length - 1: c(i).checked = False: Next: UpdateFeatures(): End Sub
Sub UpdateFeatures()
    Dim c, i, s: Set c = document.querySelectorAll(".optional-features input"): s = ""
    For i = 0 To c.length - 1: If c(i).checked Then: If Len(s) > 0 Then s = s & ",": s = s & Replace(c(i).id, "chk_", ""): End If: Next
    selectedFeatures = s: UpdateFeatureCount
End Sub
Sub UpdateFeatureCount(): Dim f, c, i: f = Split(selectedFeatures, ","): c = 0: For i = 0 To UBound(f): If Len(f(i)) > 0 Then c = c + 1: Next: document.getElementById("featureCount").innerText = "3 core + " & c & " optional": End Sub

Sub RefreshDrives()
    On Error Resume Next
    If wmi Is Nothing Then Set wmi = GetObject("winmgmts:\\.\root\cimv2")
    ReDim drives(0): driveCount = 0: Dim html: html = ""
    For Each disk In wmi.ExecQuery("SELECT * FROM Win32_DiskDrive WHERE MediaType LIKE '%Removable%' OR InterfaceType='USB'")
        If disk.Size > 0 And InStr(LCase(disk.PNPDeviceID), "virtual") = 0 Then
            ReDim Preserve drives(driveCount): drives(driveCount) = disk.Index
            html = html & "<div class='drive-item' onclick='SelectDrive(" & driveCount & ")'><div class='drive-icon'>USB</div><div class='drive-info'><div class='drive-name'>" & disk.Model & "</div><div class='drive-size'>" & FormatNumber(disk.Size / 1073741824, 1) & " GB</div></div></div>"
            driveCount = driveCount + 1
        End If
    Next
    On Error Goto 0
    If driveCount = 0 Then html = "<div class='no-drives'>No USB drives. Click Refresh.</div>"
    document.getElementById("driveList").innerHTML = html: selectedDrive = "": selectedDriveNumber = -1: UpdateFooterButtons()
End Sub

Sub SelectDrive(index)
    Dim items, i: Set items = document.getElementsByClassName("drive-item")
    For i = 0 To items.length - 1: items(i).className = "drive-item": Next
    items(index).className = "drive-item selected": selectedDriveNumber = drives(index)
    selectedDrive = items(index).getElementsByClassName("drive-name")(0).innerText: UpdateFooterButtons()
End Sub

Sub SetPartitionStyle(s): partitionStyle = s: End Sub
Sub SetQuickFormat(): quickFormat = document.getElementById("chkQuickFormat").checked: End Sub

Sub GoToStep(n)
    currentStep = n: Dim s, i: Set s = document.getElementsByClassName("slide")
    For i = 0 To s.length - 1: s(i).className = "slide": Next: document.getElementById("step" & n).className = "slide active"
    Set s = document.getElementsByClassName("step-crumb")
    For i = 0 To s.length - 1: If i + 1 < n Then s(i).className = "step-crumb done" ElseIf i + 1 = n Then s(i).className = "step-crumb active" Else s(i).className = "step-crumb": Next
    If n = 2 Then RefreshDrives(): document.getElementById("editionDisplay").innerHTML = "<span class='edition-badge'>" & EDITION_NAME & "</span>"
    If n = 3 Then document.getElementById("confirmDrive").innerText = selectedDrive: document.getElementById("confirmEdition").innerHTML = "<span class='edition-badge'>" & EDITION_NAME & "</span>": document.getElementById("confirmPartStyle").innerText = partitionStyle: document.getElementById("confirmFeatures").innerText = GetFeatureCountText()
    If n = 4 Then document.getElementById("progressBar").style.width = "0%": document.getElementById("progressPercent").innerText = "0%": smoothProgress = 0
    UpdateFooterButtons()
End Sub

Sub UpdateFooterButtons()
    Dim b, n: Set b = document.getElementById("btnBack"): Set n = document.getElementById("btnNext")
    If currentStep = 1 Then b.className = "btn btn-secondary hidden": n.innerText = "Next": n.disabled = False
    ElseIf currentStep = 2 Then b.className = "btn btn-secondary": n.innerText = "Next": n.disabled = (selectedDriveNumber < 0)
    ElseIf currentStep = 3 Then b.className = "btn btn-secondary": n.innerText = "Create USB": n.className = "btn btn-primary btn-create": n.disabled = False
    ElseIf currentStep = 4 Then b.className = "btn btn-secondary hidden": n.innerText = "Creating...": n.disabled = True
    ElseIf currentStep = 5 Then b.className = "btn btn-secondary hidden": n.innerText = "Close": n.disabled = False
    End If
End Sub

Function GetFeatureCountText(): Dim f, c, i: f = Split(selectedFeatures, ","): c = 0: For i = 0 To UBound(f): If Len(f(i)) > 0 Then c = c + 1: Next: GetFeatureCountText = "3 core + " & c & " optional": End Function
Function IIf(c, t, f): If c Then IIf = t Else IIf = f: End Function
Sub OnBackClick(): If currentStep > 1 And currentStep < 4 Then GoToStep(currentStep - 1): End Sub
Sub OnNextClick(): If currentStep = 1 Then GoToStep(2) ElseIf currentStep = 2 And selectedDriveNumber >= 0 Then GoToStep(3) ElseIf currentStep = 3 Then StartCreation() ElseIf currentStep = 5 Then window.close(): End Sub
Sub StartCreation(): GoToStep(4): CreateUSB(): End Sub

Sub CreateUSB()
    Dim tempDir, psFile, progressFile, ts
    tempDir = shell.ExpandEnvironmentStrings("%TEMP%"): psFile = tempDir & "\aegis_creator.ps1": progressFile = tempDir & "\aegis_progress.txt"
    If fso.FileExists(progressFile) Then fso.DeleteFile progressFile
    Set ts = fso.CreateTextFile(psFile, True): ts.Write GetPowerShellCode(): ts.Close
    progressTimer = window.setInterval(GetRef("CheckProgress"), 500)
    shell.Run "powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -File """ & psFile & """ -DiskNumber " & selectedDriveNumber & " -Edition """ & EDITION_NAME & """ -ProgressFile """ & progressFile & """", 0, False
End Sub

Function GetPowerShellCode()
    Dim c: c = "param([int]$DiskNumber, [string]$Edition, [string]$ProgressFile)" & vbCrLf
    c = c & "function Write-P { param([int]$P, [string]$S, [string]$D=''); ""$P|$S|$D"" | Out-File $ProgressFile -Encoding UTF8 -Force }" & vbCrLf
    c = c & "try { Write-P 0 'Initializing...' ""$Edition""" & vbCrLf
    c = c & "$disk = Get-Disk -Number $DiskNumber; if ($disk.IsSystem) { Write-P -1 'SYSTEM_DRIVE'; exit 1 }" & vbCrLf
    c = c & "$tempDir = ""$env:TEMP\AegisOS""; New-Item -ItemType Directory -Path $tempDir -Force | Out-Null" & vbCrLf
    c = c & "$isoPath = ""$tempDir\base.iso""; $isoUrl = 'https://repo.linuxliteos.com/linuxlite/isos/7.2/linux-lite-7.2-64bit.iso'" & vbCrLf
    c = c & "Write-P 5 'Downloading...' ""Aegis OS $Edition""" & vbCrLf
    c = c & "$webRequest = [System.Net.HttpWebRequest]::Create($isoUrl); $response = $webRequest.GetResponse(); $totalBytes = $response.ContentLength" & vbCrLf
    c = c & "$responseStream = $response.GetResponseStream(); $fileStream = [System.IO.File]::Create($isoPath)" & vbCrLf
    c = c & "$buffer = New-Object byte[] 8MB; $downloadedBytes = 0; $lastTime = Get-Date" & vbCrLf
    c = c & "while (($bytesRead = $responseStream.Read($buffer, 0, $buffer.Length)) -gt 0) {" & vbCrLf
    c = c & "  $fileStream.Write($buffer, 0, $bytesRead); $downloadedBytes += $bytesRead; $pct = [int](($downloadedBytes / $totalBytes) * 100)" & vbCrLf
    c = c & "  if ((Get-Date) - $lastTime).TotalSeconds -ge 1) { Write-P (8 + [int]($pct * 0.40)) 'Downloading...' ""$pct%""; $lastTime = Get-Date }}" & vbCrLf
    c = c & "$fileStream.Close(); $responseStream.Close()" & vbCrLf
    c = c & "Write-P 50 'Verifying...' 'SHA256'" & vbCrLf
    c = c & "Write-P 54 'Preparing USB...' ''; $dp = ""select disk $DiskNumber`nclean`noffline disk`nexit""; $dp | Out-File ""$tempDir\dp.txt"" -Encoding ASCII; diskpart /s ""$tempDir\dp.txt"" | Out-Null" & vbCrLf
    c = c & "Write-P 56 'Writing...' 'Do not remove!'; $phys = '\\.\PhysicalDrive' + $DiskNumber; Start-Sleep -Seconds 2" & vbCrLf
    c = c & "$src = [IO.File]::OpenRead($isoPath); $dst = New-Object IO.FileStream($phys, [IO.FileMode]::Open, [IO.FileAccess]::ReadWrite, [IO.FileShare]::None, 4MB)" & vbCrLf
    c = c & "$buf = New-Object byte[] 4MB; $written = 0; $total = $src.Length; $lastUpdate = Get-Date" & vbCrLf
    c = c & "while (($read = $src.Read($buf, 0, $buf.Length)) -gt 0) { $dst.Write($buf, 0, $read); $written += $read; $pct = [int](($written / $total) * 100)" & vbCrLf
    c = c & "  if ((Get-Date) - $lastUpdate).TotalSeconds -ge 1) { Write-P (56 + [int]($pct * 0.40)) 'Writing...' ""$pct%""; $lastUpdate = Get-Date }}" & vbCrLf
    c = c & "$dst.Close(); $src.Close()" & vbCrLf
    c = c & "$dp2 = ""select disk $DiskNumber`nonline disk`nexit""; $dp2 | Out-File ""$tempDir\dp2.txt"" -Encoding ASCII; diskpart /s ""$tempDir\dp2.txt"" | Out-Null" & vbCrLf
    c = c & "Remove-Item $tempDir -Recurse -Force -ErrorAction SilentlyContinue" & vbCrLf
    c = c & "Write-P 100 ""SUCCESS! Aegis OS $Edition ready!"" 'Safe to remove.'" & vbCrLf
    c = c & "} catch { Write-P -1 $_.Exception.Message; exit 1 }" & vbCrLf
    GetPowerShellCode = c
End Function

Sub CheckProgress()
    On Error Resume Next
    Dim progressFile, ts, line, parts, pct
    progressFile = shell.ExpandEnvironmentStrings("%TEMP%") & "\aegis_progress.txt"
    If fso.FileExists(progressFile) Then
        Set ts = fso.OpenTextFile(progressFile, 1): line = ts.ReadLine(): ts.Close
        parts = Split(line, "|"): If IsNumeric(parts(0)) Then pct = CInt(parts(0)) Else pct = 0
        If pct = -1 Then window.clearInterval progressTimer: ShowError parts(1), ""
        ElseIf pct = 100 Then window.clearInterval progressTimer: UpdateProgress 100, parts(1), "": window.setTimeout GetRef("GoToStepFive"), 1500
        Else If pct > smoothProgress Then smoothProgress = smoothProgress + 2: If smoothProgress > pct Then smoothProgress = pct: UpdateProgress smoothProgress, parts(1), IIf(UBound(parts) >= 2, parts(2), "")
    End If
    On Error Goto 0
End Sub

Sub GoToStepFive(): GoToStep(5): End Sub
Sub UpdateProgress(pct, status, detail): document.getElementById("progressBar").style.width = pct & "%": document.getElementById("progressPercent").innerText = pct & "%": document.getElementById("progressStatus").innerText = status: document.getElementById("progressDetail").innerText = detail: End Sub
Sub ShowError(msg, detail): document.getElementById("progressContainer").innerHTML = "<div style='font-size:32px;color:#ef4444'>&#10060;</div><div style='color:#ef4444;margin:8px'>Error</div><div class='error-box'>" & msg & "</div>": currentStep = 1: UpdateFooterButtons(): End Sub
</script>
</head>
<body>
<div class="wizard">
    <div class="wizard-header">
        <svg class="logo-svg shield-animate" viewBox="0 0 48 48" fill="none"><path d="M24 4L6 12v12c0 11 8 17 18 20 10-3 18-9 18-20V12L24 4z" fill="url(#sg)" stroke="#d946ef" stroke-width="2"/><path d="M17 24l5 5 9-10" stroke="#fff" stroke-width="3" stroke-linecap="round"/><defs><linearGradient id="sg" x1="6" y1="4" x2="42" y2="44"><stop stop-color="#c026d3"/><stop offset="1" stop-color="#d946ef"/></linearGradient></defs></svg>
        <div class="header-text"><h1>Aegis OS Gamer+AI Edition</h1><p>Gaming performance + AI development</p></div>
    </div>
    <div class="wizard-breadcrumb"><div class="step-crumb active">1. Features</div><div class="step-crumb">2. USB Drive</div><div class="step-crumb">3. Confirm</div><div class="step-crumb">4. Creating</div><div class="step-crumb">5. Done</div></div>
    <div class="wizard-content">
        <div id="step1" class="slide active">
            <div class="section-title">Select Features <span class="edition-badge">Gamer+AI</span></div>
            <div class="section-desc">Ultimate gaming + AI development platform.</div>
            <div class="sys-req-box"><div style="font-size:9px;color:#d946ef;margin-bottom:4px;font-weight:600">System Check</div><div id="sysReqContent" style="display:flex;gap:12px;">Checking...</div></div>
            <div class="feature-section"><div class="feature-section-title">Core Features</div><div class="core-features"><div class="core-feature-item"><span class="icon">&#10003;</span> Aegis OS Gamer+AI Base</div><div class="core-feature-item"><span class="icon">&#10003;</span> Low-latency Kernel</div><div class="core-feature-item"><span class="icon">&#10003;</span> CUDA/ROCm Drivers</div></div></div>
            <div class="feature-section" style="flex:1;display:flex;flex-direction:column;"><div class="feature-section-title">Gamer+AI Features</div><div class="feature-actions"><button class="btn btn-secondary btn-small" onclick="SelectAllFeatures()">All</button><button class="btn btn-secondary btn-small" onclick="DeselectAllFeatures()">None</button></div>
                <div class="optional-features">
                    <div class="feature-card"><input type="checkbox" id="chk_gaming" checked onclick="ToggleFeature('gaming')"><div class="feature-card-content"><div class="feature-card-name">Gaming Optimizer</div><div class="feature-card-desc">FPS boost, latency reduction</div></div></div>
                    <div class="feature-card"><input type="checkbox" id="chk_ai_toolkit" checked onclick="ToggleFeature('ai_toolkit')"><div class="feature-card-content"><div class="feature-card-name">AI Toolkit</div><div class="feature-card-desc">PyTorch, TensorFlow, ML</div></div></div>
                    <div class="feature-card"><input type="checkbox" id="chk_stream" checked onclick="ToggleFeature('stream')"><div class="feature-card-content"><div class="feature-card-name">Aegis Stream</div><div class="feature-card-desc">4K game streaming</div></div></div>
                    <div class="feature-card"><input type="checkbox" id="chk_fps_boost" checked onclick="ToggleFeature('fps_boost')"><div class="feature-card-content"><div class="feature-card-name">FPS Boost Mode</div><div class="feature-card-desc">Maximum performance</div></div></div>
                </div>
                <div id="featureCount" class="feature-count">3 core + 4 optional</div>
            </div>
        </div>
        <div id="step2" class="slide">
            <div class="section-title">Select USB Drive</div><div class="section-desc">Installing: <span id="editionDisplay">-</span></div>
            <div class="warning-box"><strong>&#9888; Warning:</strong> All data will be erased.</div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;"><span style="font-size:10px;color:#aaa;">USB Drives:</span><button class="btn btn-refresh" onclick="RefreshDrives()">&#8635; Refresh</button></div>
            <div id="driveList" class="drive-list"><div class="no-drives">Click Refresh.</div></div>
            <div class="option-group"><span class="option-label">Partition Style:</span><div class="radio-group"><label class="radio-item"><input type="radio" name="ps" checked onclick="SetPartitionStyle('GPT')"> GPT</label><label class="radio-item"><input type="radio" name="ps" onclick="SetPartitionStyle('MBR')"> MBR</label></div></div>
            <label class="checkbox-item"><input type="checkbox" id="chkQuickFormat" checked onclick="SetQuickFormat()"> Quick Format</label>
        </div>
        <div id="step3" class="slide">
            <div class="section-title">Confirm Settings</div>
            <div class="warning-box"><strong>&#9888; Final Warning:</strong> All data will be erased!</div>
            <div class="confirm-grid"><div class="confirm-item"><div class="confirm-label">Target Drive</div><div class="confirm-value" id="confirmDrive">-</div></div><div class="confirm-item"><div class="confirm-label">Edition</div><div class="confirm-value" id="confirmEdition">-</div></div><div class="confirm-item"><div class="confirm-label">Partition</div><div class="confirm-value" id="confirmPartStyle">GPT</div></div><div class="confirm-item"><div class="confirm-label">Features</div><div class="confirm-value" id="confirmFeatures">-</div></div></div>
            <div class="info-box"><h3>What happens:</h3><ul><li>Download (~2.9 GB)</li><li>Verify SHA256</li><li>Write to USB</li><li>~15-30 min</li></ul></div>
        </div>
        <div id="step4" class="slide">
            <div class="section-title">Creating USB</div><div class="section-desc">Do not remove USB.</div>
            <div id="progressContainer" class="progress-container"><div class="progress-percent" id="progressPercent">0%</div><div class="progress-bar-bg"><div class="progress-bar-fill animated" id="progressBar"></div></div><div class="progress-status" id="progressStatus">Starting...</div><div class="progress-detail" id="progressDetail"></div></div>
        </div>
        <div id="step5" class="slide">
            <div class="success-container"><div class="success-icon">&#10004;</div><div class="success-title">USB Created!</div><div class="success-desc">Aegis OS Gamer+AI ready.</div><div class="success-steps"><h3>Next Steps:</h3><ol><li>Eject USB</li><li>Boot from USB</li><li>Install Aegis OS</li></ol></div></div>
        </div>
    </div>
    <div class="wizard-footer"><button id="btnBack" class="btn btn-secondary hidden" onclick="OnBackClick()">Back</button><button id="btnNext" class="btn btn-primary" onclick="OnNextClick()">Next</button></div>
</div>
</body>
</html>
