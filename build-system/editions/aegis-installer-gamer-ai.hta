<html>
<head>
<title>Aegis OS ISO Downloader - Gamer+AI Edition</title>
<HTA:APPLICATION ID="AegisGamerAIDownloader" APPLICATIONNAME="Aegis OS Gamer+AI Edition" BORDER="thick" BORDERSTYLE="raised" CAPTION="yes" MAXIMIZEBUTTON="no" MINIMIZEBUTTON="yes" SHOWINTASKBAR="yes" SINGLEINSTANCE="yes" SYSMENU="yes" VERSION="5.0" SCROLL="no"/>
<style>
body { margin:0; padding:0; font-family:'Segoe UI',Tahoma,Arial,sans-serif; font-size:13px; background:#F3F3F3; color:#1A1A1A; }
.header { background:linear-gradient(135deg,#9933FF 0%,#7A29CC 100%); color:white; padding:20px; }
.header h1 { margin:0; font-size:20px; font-weight:600; }
.header .edition { font-size:12px; opacity:0.9; margin-top:4px; }
.content { padding:20px; }
.footer { background:#E6E6E6; padding:12px 20px; border-top:1px solid #CCCCCC; text-align:right; }
.btn { padding:10px 20px; margin-left:8px; border:1px solid #CCCCCC; background:white; font-size:13px; font-family:inherit; cursor:pointer; border-radius:3px; min-width:100px; }
.btn:hover { background:#F0F0F0; border-color:#999999; }
.btn:disabled { background:#F5F5F5; color:#999999; cursor:not-allowed; }
.btn-primary { background:#9933FF; color:white; border-color:#9933FF; font-weight:600; }
.btn-primary:hover { background:#7A29CC; border-color:#7A29CC; }
.btn-primary:disabled { background:#CC99FF; border-color:#CC99FF; }
.section { background:white; border:1px solid #E0E0E0; border-radius:4px; margin-bottom:16px; padding:16px; }
.section-title { font-weight:600; font-size:14px; margin-bottom:10px; color:#9933FF; }
.progress-container { text-align:center; padding:20px; }
.progress-pct { font-size:48px; font-weight:300; color:#9933FF; margin-bottom:10px; }
.progress-bar-bg { background:#E0E0E0; height:8px; border-radius:4px; overflow:hidden; margin-bottom:12px; }
.progress-bar { height:100%; background:#9933FF; transition:width 0.3s ease; }
.progress-status { font-size:14px; color:#333333; margin-bottom:4px; }
.progress-detail { font-size:12px; color:#666666; }
.success-box { text-align:center; padding:20px; }
.success-icon { font-size:48px; color:#9933FF; margin-bottom:10px; }
.success-title { font-size:18px; font-weight:600; color:#9933FF; margin-bottom:8px; }
.info-box { background:#F0E8FF; border:1px solid #9933FF; border-radius:4px; padding:14px; margin:12px 0; }
.warning-box { background:#FFF8E1; border:1px solid #FFA000; border-radius:4px; padding:14px; margin:12px 0; }
.steps-list { margin:10px 0; padding-left:20px; }
.steps-list li { padding:6px 0; }
.features-list { margin:8px 0; padding-left:0; list-style:none; columns:2; column-gap:12px; }
.features-list li { padding:3px 0 3px 16px; position:relative; font-size:11px; break-inside:avoid; }
.features-list li:before { content:"\2713"; position:absolute; left:0; color:#9933FF; font-weight:bold; }
.checksum { font-family:Consolas,monospace; font-size:11px; background:#F5F5F5; padding:8px; border-radius:3px; word-break:break-all; margin-top:8px; }
.link { color:#0066CC; cursor:pointer; text-decoration:underline; }
</style>
<script language="VBScript">
Dim shell, fso, progressTimer, downloadFolder, currentStep

Sub Window_OnLoad()
    window.resizeTo 600, 520
    Set shell = CreateObject("WScript.Shell")
    Set fso = CreateObject("Scripting.FileSystemObject")
    downloadFolder = shell.ExpandEnvironmentStrings("%USERPROFILE%") & "\Downloads"
    currentStep = 1
    ShowStep 1
End Sub

Sub ShowStep(stepNum)
    document.getElementById("step1").style.display = "none"
    document.getElementById("step2").style.display = "none"
    document.getElementById("step3").style.display = "none"
    document.getElementById("step" & stepNum).style.display = ""
    currentStep = stepNum
End Sub

Sub BrowseFolder()
    Dim folderPath
    Set objShell = CreateObject("Shell.Application")
    Set objFolder = objShell.BrowseForFolder(0, "Select download location:", 0, downloadFolder)
    If Not objFolder Is Nothing Then
        downloadFolder = objFolder.Self.Path
        document.getElementById("folderPath").innerText = downloadFolder
    End If
End Sub

Sub StartDownload()
    Dim tempDir, psFile, progressFile, psCode, ts
    tempDir = shell.ExpandEnvironmentStrings("%TEMP%")
    psFile = tempDir & "\aegis_download.ps1"
    progressFile = tempDir & "\aegis_progress.txt"
    If fso.FileExists(progressFile) Then fso.DeleteFile progressFile
    psCode = GetDownloadScript()
    Set ts = fso.CreateTextFile(psFile, True)
    ts.Write psCode
    ts.Close
    ShowStep 2
    progressTimer = window.setInterval(GetRef("CheckProgress"), 500)
    shell.Run "powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -File """ & psFile & """ -DownloadFolder """ & downloadFolder & """ -ProgressFile """ & progressFile & """", 0, False
End Sub

Function GetDownloadScript()
    Dim code
    code = "param([string]$DownloadFolder, [string]$ProgressFile)" & vbCrLf
    code = code & "$ErrorActionPreference = 'Stop'" & vbCrLf
    code = code & "function Write-P { param([int]$P, [string]$S, [string]$D=''); ""$P|$S|$D"" | Out-File $ProgressFile -Encoding UTF8 -Force }" & vbCrLf
    code = code & "try {" & vbCrLf
    code = code & "Write-P 0 'Initializing download...' 'Aegis OS Gamer+AI Edition'" & vbCrLf
    code = code & "$isoPath = Join-Path $DownloadFolder 'AegisOS-GamerAI.iso'" & vbCrLf
    code = code & "$mirrors = @('https://repo.linuxliteos.com/linuxlite/isos/7.2/linux-lite-7.2-64bit.iso','https://mirror.freedif.org/LinuxLiteOS/isos/7.2/linux-lite-7.2-64bit.iso')" & vbCrLf
    code = code & "$expectedHash = 'DC8955E02C68537815ED0010F7C4C035CE786BBA2C679DD74532B22205DF8216'" & vbCrLf
    code = code & "Write-P 2 'Connecting to server...' ''" & vbCrLf
    code = code & "$dlSuccess = $false" & vbCrLf
    code = code & "foreach ($url in $mirrors) {" & vbCrLf
    code = code & "  try {" & vbCrLf
    code = code & "    $web = [Net.HttpWebRequest]::Create($url); $web.UserAgent = 'AegisOS/5.0'; $web.Timeout = 30000; $resp = $web.GetResponse(); $total = $resp.ContentLength; $rs = $resp.GetResponseStream(); $fs = [IO.File]::Create($isoPath); $buf = New-Object byte[] 8MB; $dl = 0; $st = Get-Date; $lt = $st" & vbCrLf
    code = code & "    while (($br = $rs.Read($buf, 0, $buf.Length)) -gt 0) {" & vbCrLf
    code = code & "      $fs.Write($buf, 0, $br); $dl += $br; $now = Get-Date" & vbCrLf
    code = code & "      if (($now - $lt).TotalSeconds -ge 0.5) {" & vbCrLf
    code = code & "        $p = [int](($dl / $total) * 100); $el = ($now - $st).TotalSeconds" & vbCrLf
    code = code & "        if ($el -gt 0) { $spd = $dl / $el / 1MB; $rem = ($total - $dl) / ($dl / $el); $eta = [TimeSpan]::FromSeconds([Math]::Max(0,$rem)).ToString('mm\\:ss') }" & vbCrLf
    code = code & "        Write-P ([int]($p * 0.90)) ""Downloading: $p%"" ""$([math]::Round($spd,1)) MB/s - $eta remaining""; $lt = $now" & vbCrLf
    code = code & "      }" & vbCrLf
    code = code & "    }" & vbCrLf
    code = code & "    $fs.Close(); $rs.Close(); $dlSuccess = $true; break" & vbCrLf
    code = code & "  } catch { continue }" & vbCrLf
    code = code & "}" & vbCrLf
    code = code & "if (-not $dlSuccess) { Write-P -1 'ERROR: Download failed' 'Could not connect to download servers'; exit 1 }" & vbCrLf
    code = code & "Write-P 92 'Verifying checksum...' 'This may take a moment'" & vbCrLf
    code = code & "$hash = (Get-FileHash $isoPath -Algorithm SHA256).Hash" & vbCrLf
    code = code & "if ($hash -ne $expectedHash) { Write-P -1 'ERROR: Checksum failed' 'File may be corrupted'; exit 1 }" & vbCrLf
    code = code & "Write-P 100 'SUCCESS' ""$isoPath|$hash""" & vbCrLf
    code = code & "} catch { Write-P -1 ""ERROR: $($_.Exception.Message)"" 'Download failed'; exit 1 }" & vbCrLf
    GetDownloadScript = code
End Function

Sub CheckProgress()
    Dim progressFile, ts, line, parts, pct, status, detail
    progressFile = shell.ExpandEnvironmentStrings("%TEMP%") & "\aegis_progress.txt"
    On Error Resume Next
    If fso.FileExists(progressFile) Then
        Set ts = fso.OpenTextFile(progressFile, 1)
        line = ts.ReadLine()
        ts.Close
        parts = Split(line, "|")
        pct = CInt(parts(0))
        status = parts(1)
        detail = ""
        If UBound(parts) >= 2 Then detail = parts(2)
        If pct = -1 Then
            window.clearInterval progressTimer
            document.getElementById("progressStatus").innerText = status
            document.getElementById("progressDetail").innerText = detail
            document.getElementById("progressPct").innerText = "!"
            document.getElementById("progressBar").style.width = "100%"
            document.getElementById("progressBar").style.background = "#E53935"
        ElseIf pct = 100 Then
            window.clearInterval progressTimer
            Dim successParts
            successParts = Split(detail, "|")
            document.getElementById("isoPath").innerText = successParts(0)
            document.getElementById("isoHash").innerText = successParts(1)
            ShowStep 3
        Else
            document.getElementById("progressPct").innerText = pct & "%"
            document.getElementById("progressBar").style.width = pct & "%"
            document.getElementById("progressStatus").innerText = status
            document.getElementById("progressDetail").innerText = detail
        End If
    End If
    On Error Goto 0
End Sub

Sub OpenFolder()
    shell.Run "explorer.exe """ & downloadFolder & """"
End Sub

Sub OpenEtcher()
    shell.Run "https://etcher.balena.io/"
End Sub

Sub CloseApp()
    window.close
End Sub
</script>
</head>
<body>
<div class="header">
    <h1>Aegis OS ISO Downloader</h1>
    <div class="edition">Gamer+AI Edition - Gaming Meets Intelligence</div>
</div>
<div class="content">
    <div id="step1">
        <div class="section">
            <div class="section-title">Welcome</div>
            <p>This tool will download the Aegis OS Gamer+AI Edition ISO file to your computer.</p>
            <p>After downloading, you'll use <strong>Balena Etcher</strong> (free software) to create a bootable USB drive.</p>
        </div>
        <div class="section">
            <div class="section-title">Included Features</div>
            <p style="font-size:11px;margin:0 0 6px 0;font-weight:600;">All Gamer Edition features PLUS:</p>
            <ul class="features-list">
                <li>AI-powered game companion</li>
                <li>Real-time game translation (40+ languages)</li>
                <li>Automatic highlight detection and clipping</li>
                <li>Neural network upscaling (DLSS 3.5, FSR 3.0, XeSS)</li>
                <li>AI streaming overlays with chat sentiment</li>
                <li>Smart VRAM management</li>
                <li>ML-powered performance prediction</li>
                <li>AI texture upscaling for older games</li>
                <li>Voice command gaming controls</li>
                <li>Predictive game loading</li>
                <li>AI mod recommendations</li>
                <li>Stream analytics dashboard</li>
                <li>Auto-generated thumbnails and titles</li>
                <li>Game AI training sandbox</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Download Location</div>
            <p>The ISO will be saved to:</p>
            <p><strong id="folderPath">C:\Users\...\Downloads</strong></p>
            <button class="btn" onclick="BrowseFolder()">Change Folder</button>
        </div>
        <div class="info-box">
            <strong>What you'll need:</strong>
            <ul class="steps-list">
                <li>About 3 GB of free disk space</li>
                <li>A stable internet connection</li>
                <li>A USB drive (8 GB or larger) for installation</li>
            </ul>
        </div>
    </div>
    <div id="step2" style="display:none;">
        <div class="section">
            <div class="progress-container">
                <div class="progress-pct" id="progressPct">0%</div>
                <div class="progress-bar-bg"><div class="progress-bar" id="progressBar" style="width:0%;"></div></div>
                <div class="progress-status" id="progressStatus">Starting download...</div>
                <div class="progress-detail" id="progressDetail"></div>
            </div>
        </div>
        <div class="warning-box">
            <strong>Please wait</strong> - Do not close this window while downloading.
        </div>
    </div>
    <div id="step3" style="display:none;">
        <div class="section">
            <div class="success-box">
                <div class="success-icon">&#10004;</div>
                <div class="success-title">Download Complete!</div>
                <p>Your ISO file is ready.</p>
            </div>
        </div>
        <div class="section">
            <div class="section-title">ISO File Location</div>
            <p id="isoPath" style="font-family:Consolas;font-size:12px;"></p>
            <button class="btn" onclick="OpenFolder()">Open Folder</button>
        </div>
        <div class="section">
            <div class="section-title">SHA256 Checksum (for verification)</div>
            <div class="checksum" id="isoHash"></div>
        </div>
        <div class="info-box">
            <div class="section-title">Next Steps - Create Bootable USB</div>
            <ol class="steps-list">
                <li>Download and install <span class="link" onclick="OpenEtcher()">Balena Etcher</span> (free)</li>
                <li>Insert your USB drive (8 GB or larger)</li>
                <li>Open Balena Etcher and click "Flash from file"</li>
                <li>Select the downloaded ISO file</li>
                <li>Select your USB drive and click "Flash!"</li>
                <li>Once complete, restart your computer and boot from USB</li>
            </ol>
        </div>
    </div>
</div>
<div class="footer">
    <button class="btn" onclick="CloseApp()" id="btnCancel">Cancel</button>
    <button class="btn btn-primary" onclick="StartDownload()" id="btnDownload">Download ISO</button>
</div>
</body>
</html>
