<html>
<head>
<title>Aegis OS ISO Downloader - Gamer Edition</title>
<HTA:APPLICATION ID="AegisGamerDownloader" APPLICATIONNAME="Aegis OS Gamer Edition" BORDER="thick" BORDERSTYLE="raised" CAPTION="yes" MAXIMIZEBUTTON="no" MINIMIZEBUTTON="yes" SHOWINTASKBAR="yes" SINGLEINSTANCE="yes" SYSMENU="yes" VERSION="5.0" SCROLL="no"/>
<style>
body { margin:0; padding:0; font-family:'Segoe UI',Tahoma,Arial,sans-serif; font-size:13px; background:#F3F3F3; color:#1A1A1A; }
.header { background:linear-gradient(135deg,#CC0000 0%,#990000 100%); color:white; padding:20px; }
.header h1 { margin:0; font-size:20px; font-weight:600; }
.header .edition { font-size:12px; opacity:0.9; margin-top:4px; }
.content { padding:20px; }
.footer { background:#E6E6E6; padding:12px 20px; border-top:1px solid #CCCCCC; text-align:right; }
.btn { padding:10px 20px; margin-left:8px; border:1px solid #CCCCCC; background:white; font-size:13px; font-family:inherit; cursor:pointer; border-radius:3px; min-width:100px; }
.btn:hover { background:#F0F0F0; border-color:#999999; }
.btn:disabled { background:#F5F5F5; color:#999999; cursor:not-allowed; }
.btn-primary { background:#CC0000; color:white; border-color:#CC0000; font-weight:600; }
.btn-primary:hover { background:#990000; border-color:#990000; }
.btn-primary:disabled { background:#E68080; border-color:#E68080; }
.section { background:white; border:1px solid #E0E0E0; border-radius:4px; margin-bottom:16px; padding:16px; }
.section-title { font-weight:600; font-size:14px; margin-bottom:10px; color:#CC0000; }
.progress-container { text-align:center; padding:20px; }
.progress-pct { font-size:48px; font-weight:300; color:#CC0000; margin-bottom:10px; }
.progress-bar-bg { background:#E0E0E0; height:8px; border-radius:4px; overflow:hidden; margin-bottom:12px; }
.progress-bar { height:100%; background:#CC0000; transition:width 0.3s ease; }
.progress-status { font-size:14px; color:#333333; margin-bottom:4px; }
.progress-detail { font-size:12px; color:#666666; }
.success-box { text-align:center; padding:20px; }
.success-icon { font-size:48px; color:#CC0000; margin-bottom:10px; }
.success-title { font-size:18px; font-weight:600; color:#CC0000; margin-bottom:8px; }
.info-box { background:#FFE8E8; border:1px solid #CC0000; border-radius:4px; padding:14px; margin:12px 0; }
.warning-box { background:#FFF8E1; border:1px solid #FFA000; border-radius:4px; padding:14px; margin:12px 0; }
.steps-list { margin:10px 0; padding-left:20px; }
.steps-list li { padding:6px 0; }
.features-list { margin:8px 0; padding-left:0; list-style:none; columns:2; column-gap:12px; }
.features-list li { padding:3px 0 3px 16px; position:relative; font-size:11px; break-inside:avoid; }
.features-list li:before { content:"\2713"; position:absolute; left:0; color:#CC0000; font-weight:bold; }
.checksum { font-family:Consolas,monospace; font-size:11px; background:#F5F5F5; padding:8px; border-radius:3px; word-break:break-all; margin-top:8px; }
.link { color:#0066CC; cursor:pointer; text-decoration:underline; }
</style>
<script language="VBScript">
Dim shell, fso, progressTimer, downloadFolder, currentStep

Sub Window_OnLoad()
    window.resizeTo 700, 700
    Set shell = CreateObject("WScript.Shell")
    Set fso = CreateObject("Scripting.FileSystemObject")
    downloadFolder = shell.ExpandEnvironmentStrings("%USERPROFILE%") & "\Downloads"
    currentStep = 1
    ShowStep 1
End Sub

Sub ShowStep(stepNum)
    document.getElementById("step1").style.display = "none"
    document.getElementById("step2").style.display = "none"
    document.getElementById("step3").style.display = "none"
    document.getElementById("step" & stepNum).style.display = ""
    currentStep = stepNum
End Sub

Sub BrowseFolder()
    Dim folderPath
    Set objShell = CreateObject("Shell.Application")
    Set objFolder = objShell.BrowseForFolder(0, "Select download location:", 0, downloadFolder)
    If Not objFolder Is Nothing Then
        downloadFolder = objFolder.Self.Path
        document.getElementById("folderPath").innerText = downloadFolder
    End If
End Sub

Sub StartDownload()
    Dim tempDir, psFile, progressFile, psCode, ts
    tempDir = shell.ExpandEnvironmentStrings("%TEMP%")
    psFile = tempDir & "\aegis_download.ps1"
    progressFile = tempDir & "\aegis_progress.txt"
    If fso.FileExists(progressFile) Then fso.DeleteFile progressFile
    psCode = GetDownloadScript()
    Set ts = fso.CreateTextFile(psFile, True)
    ts.Write psCode
    ts.Close
    ShowStep 2
    progressTimer = window.setInterval(GetRef("CheckProgress"), 500)
    shell.Run "powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -File """ & psFile & """ -DownloadFolder """ & downloadFolder & """ -ProgressFile """ & progressFile & """", 0, False
End Sub

Function GetDownloadScript()
    Dim code
    code = "param([string]$DownloadFolder, [string]$ProgressFile)" & vbCrLf
    code = code & "$ErrorActionPreference = 'Stop'" & vbCrLf
    code = code & "function Write-P { param([int]$P, [string]$S, [string]$D=''); ""$P|$S|$D"" | Out-File $ProgressFile -Encoding UTF8 -Force }" & vbCrLf
    code = code & "try {" & vbCrLf
    code = code & "Write-P 0 'Initializing download...' 'Aegis OS Gamer Edition'" & vbCrLf
    code = code & "$isoPath = Join-Path $DownloadFolder 'AegisOS-Gamer.iso'" & vbCrLf
    code = code & "$mirrors = @('https://repo.linuxliteos.com/linuxlite/isos/7.2/linux-lite-7.2-64bit.iso','https://mirror.freedif.org/LinuxLiteOS/isos/7.2/linux-lite-7.2-64bit.iso')" & vbCrLf
    code = code & "$expectedHash = 'DC8955E02C68537815ED0010F7C4C035CE786BBA2C679DD74532B22205DF8216'" & vbCrLf
    code = code & "Write-P 2 'Connecting to server...' ''" & vbCrLf
    code = code & "$dlSuccess = $false" & vbCrLf
    code = code & "foreach ($url in $mirrors) {" & vbCrLf
    code = code & "  try {" & vbCrLf
    code = code & "    $web = [Net.HttpWebRequest]::Create($url); $web.UserAgent = 'AegisOS/5.0'; $web.Timeout = 30000; $resp = $web.GetResponse(); $total = $resp.ContentLength; $rs = $resp.GetResponseStream(); $fs = [IO.File]::Create($isoPath); $buf = New-Object byte[] 8MB; $dl = 0; $st = Get-Date; $lt = $st" & vbCrLf
    code = code & "    while (($br = $rs.Read($buf, 0, $buf.Length)) -gt 0) {" & vbCrLf
    code = code & "      $fs.Write($buf, 0, $br); $dl += $br; $now = Get-Date" & vbCrLf
    code = code & "      if (($now - $lt).TotalSeconds -ge 0.5) {" & vbCrLf
    code = code & "        $p = [int](($dl / $total) * 100); $el = ($now - $st).TotalSeconds" & vbCrLf
    code = code & "        if ($el -gt 0) { $spd = $dl / $el / 1MB; $rem = ($total - $dl) / ($dl / $el); $eta = [TimeSpan]::FromSeconds([Math]::Max(0,$rem)).ToString('mm\\:ss') }" & vbCrLf
    code = code & "        Write-P ([int]($p * 0.90)) ""Downloading: $p%"" ""$([math]::Round($spd,1)) MB/s - $eta remaining""; $lt = $now" & vbCrLf
    code = code & "      }" & vbCrLf
    code = code & "    }" & vbCrLf
    code = code & "    $fs.Close(); $rs.Close(); $dlSuccess = $true; break" & vbCrLf
    code = code & "  } catch { continue }" & vbCrLf
    code = code & "}" & vbCrLf
    code = code & "if (-not $dlSuccess) { Write-P -1 'ERROR: Download failed' 'Could not connect to download servers'; exit 1 }" & vbCrLf
    code = code & "Write-P 92 'Verifying checksum...' 'This may take a moment'" & vbCrLf
    code = code & "$hash = (Get-FileHash $isoPath -Algorithm SHA256).Hash" & vbCrLf
    code = code & "if ($hash -ne $expectedHash) { Write-P -1 'ERROR: Checksum failed' 'File may be corrupted'; exit 1 }" & vbCrLf
    code = code & "Write-P 100 'SUCCESS' ""$isoPath|$hash""" & vbCrLf
    code = code & "} catch { Write-P -1 ""ERROR: $($_.Exception.Message)"" 'Download failed'; exit 1 }" & vbCrLf
    GetDownloadScript = code
End Function

Sub CheckProgress()
    Dim progressFile, ts, line, parts, pct, status, detail
    progressFile = shell.ExpandEnvironmentStrings("%TEMP%") & "\aegis_progress.txt"
    On Error Resume Next
    If fso.FileExists(progressFile) Then
        Set ts = fso.OpenTextFile(progressFile, 1)
        line = ts.ReadLine()
        ts.Close
        parts = Split(line, "|")
        pct = CInt(parts(0))
        status = parts(1)
        detail = ""
        If UBound(parts) >= 2 Then detail = parts(2)
        If pct = -1 Then
            window.clearInterval progressTimer
            document.getElementById("progressStatus").innerText = status
            document.getElementById("progressDetail").innerText = detail
            document.getElementById("progressPct").innerText = "!"
            document.getElementById("progressBar").style.width = "100%"
            document.getElementById("progressBar").style.background = "#E53935"
        ElseIf pct = 100 Then
            window.clearInterval progressTimer
            Dim successParts
            successParts = Split(detail, "|")
            document.getElementById("isoPath").innerText = successParts(0)
            document.getElementById("isoHash").innerText = successParts(1)
            ShowStep 3
        Else
            document.getElementById("progressPct").innerText = pct & "%"
            document.getElementById("progressBar").style.width = pct & "%"
            document.getElementById("progressStatus").innerText = status
            document.getElementById("progressDetail").innerText = detail
        End If
    End If
    On Error Goto 0
End Sub

Sub OpenFolder()
    shell.Run "explorer.exe """ & downloadFolder & """"
End Sub

Sub OpenEtcher()
    shell.Run "https://etcher.balena.io/"
End Sub

Sub CloseApp()
    window.close
End Sub
</script>
</head>
<body>
<div class="header">
    <h1>Aegis OS ISO Downloader</h1>
    <div class="edition">Gamer Edition - Ultimate Gaming Experience</div>
</div>
<div class="content">
    <div id="step1">
        <div class="section">
            <div class="section-title">Welcome</div>
            <p>This tool will download the Aegis OS Gamer Edition ISO file to your computer.</p>
            <p>After downloading, you'll use <strong>Balena Etcher</strong> (free software) to create a bootable USB drive.</p>
        </div>
        <div class="section">
            <div class="section-title">AI & Upscaling</div>
            <ul class="features-list">
                <li>Aegis Neural Upscaler (ANU) - Custom AI upscaling</li>
                <li>FSR 1.0/2.0/3.0 support (AMD FidelityFX)</li>
                <li>AI frame generation for smoother gameplay</li>
                <li>Real-ESRGAN texture enhancement</li>
                <li>Dynamic resolution scaling</li>
                <li>Anti-lag technology integration</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Game Management</div>
            <ul class="features-list">
                <li>Unified game launcher (Steam, GOG, Epic, Lutris, Heroic)</li>
                <li>Automatic game detection and library import</li>
                <li>SD card/USB portable game storage</li>
                <li>Proton-GE and Wine-GE pre-installed</li>
                <li>DXVK, VKD3D-Proton, and vkBasalt ready</li>
                <li>Per-game Proton version selection</li>
                <li>Custom launch options and env variables</li>
                <li>Game-specific Wine prefix management</li>
                <li>Automatic shader pre-caching</li>
                <li>Cloud save sync (Steam, GOG, custom)</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Performance Tools</div>
            <ul class="features-list">
                <li>GameMode auto-activation on launch</li>
                <li>MangoHud real-time overlay (FPS, CPU, GPU, RAM)</li>
                <li>Per-game performance profiles</li>
                <li>CPU governor optimization</li>
                <li>GPU overclocking tools (NVIDIA/AMD)</li>
                <li>VRAM usage monitoring</li>
                <li>Latency reduction optimizations</li>
                <li>Benchmarking suite with historical tracking</li>
                <li>Frame time analysis</li>
                <li>Power profile switching (Performance/Balanced/Quiet)</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Streaming & Recording</div>
            <ul class="features-list">
                <li>Aegis Stream - local game streaming</li>
                <li>OBS Studio pre-configured</li>
                <li>NVENC/VAAPI hardware encoding</li>
                <li>Instant replay (last 30/60/120 sec)</li>
                <li>AI-powered highlight detection</li>
                <li>Twitch/YouTube/Kick integration</li>
                <li>Multi-platform chat overlay</li>
                <li>Stream deck support</li>
                <li>Screenshot manager with cloud backup</li>
                <li>GIF capture tool</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Controllers & Input</div>
            <ul class="features-list">
                <li>Xbox, PlayStation, Switch Pro controller support</li>
                <li>Steam Input integration</li>
                <li>Custom controller mapping profiles</li>
                <li>Gyro aiming support</li>
                <li>Haptic feedback configuration</li>
                <li>Mouse acceleration control</li>
                <li>Keyboard macro support</li>
                <li>Fight stick and racing wheel support</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">RGB & Hardware</div>
            <ul class="features-list">
                <li>OpenRGB for RGB lighting control</li>
                <li>Razer, Corsair, Logitech, ASUS Aura support</li>
                <li>Per-game RGB profiles</li>
                <li>Fan curve customization</li>
                <li>CPU/GPU temperature monitoring</li>
                <li>Hardware sensor dashboard</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Multiplayer & Social</div>
            <ul class="features-list">
                <li>LAN party network optimization</li>
                <li>Built-in Discord rich presence</li>
                <li>Voice chat with noise cancellation</li>
                <li>Server browser for popular games</li>
                <li>Game invite system</li>
                <li>Friend activity feed</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Modding & Customization</div>
            <ul class="features-list">
                <li>Steam Workshop integration</li>
                <li>Nexus Mods manager</li>
                <li>Mod Organizer 2 support</li>
                <li>LOOT load order optimizer</li>
                <li>ENB/ReShade preset manager</li>
                <li>Save game manager with backups</li>
                <li>Cheat engine (single-player only)</li>
                <li>Texture mod tools</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Emulation</div>
            <ul class="features-list">
                <li>RetroArch with 50+ cores pre-installed</li>
                <li>Dolphin (GameCube/Wii)</li>
                <li>PCSX2 (PlayStation 2)</li>
                <li>RPCS3 (PlayStation 3)</li>
                <li>Yuzu/Ryujinx (Nintendo Switch)</li>
                <li>CEMU (Wii U)</li>
                <li>BIOS and firmware management</li>
                <li>Controller auto-configuration per emulator</li>
            </ul>
        </div>
        <div class="section">
            <div class="section-title">Download Location</div>
            <p>The ISO will be saved to:</p>
            <p><strong id="folderPath">C:\Users\...\Downloads</strong></p>
            <button class="btn" onclick="BrowseFolder()">Change Folder</button>
        </div>
        <div class="info-box">
            <strong>What you'll need:</strong>
            <ul class="steps-list">
                <li>About 3 GB of free disk space</li>
                <li>A stable internet connection</li>
                <li>A USB drive (8 GB or larger) for installation</li>
            </ul>
        </div>
    </div>
    <div id="step2" style="display:none;">
        <div class="section">
            <div class="progress-container">
                <div class="progress-pct" id="progressPct">0%</div>
                <div class="progress-bar-bg"><div class="progress-bar" id="progressBar" style="width:0%;"></div></div>
                <div class="progress-status" id="progressStatus">Starting download...</div>
                <div class="progress-detail" id="progressDetail"></div>
            </div>
        </div>
        <div class="warning-box">
            <strong>Please wait</strong> - Do not close this window while downloading.
        </div>
    </div>
    <div id="step3" style="display:none;">
        <div class="section">
            <div class="success-box">
                <div class="success-icon">&#10004;</div>
                <div class="success-title">Download Complete!</div>
                <p>Your ISO file is ready.</p>
            </div>
        </div>
        <div class="section">
            <div class="section-title">ISO File Location</div>
            <p id="isoPath" style="font-family:Consolas;font-size:12px;"></p>
            <button class="btn" onclick="OpenFolder()">Open Folder</button>
        </div>
        <div class="section">
            <div class="section-title">SHA256 Checksum (for verification)</div>
            <div class="checksum" id="isoHash"></div>
        </div>
        <div class="info-box">
            <div class="section-title">Next Steps - Create Bootable USB</div>
            <ol class="steps-list">
                <li>Download and install <span class="link" onclick="OpenEtcher()">Balena Etcher</span> (free)</li>
                <li>Insert your USB drive (8 GB or larger)</li>
                <li>Open Balena Etcher and click "Flash from file"</li>
                <li>Select the downloaded ISO file</li>
                <li>Select your USB drive and click "Flash!"</li>
                <li>Once complete, restart your computer and boot from USB</li>
            </ol>
        </div>
    </div>
</div>
<div class="footer">
    <button class="btn" onclick="CloseApp()" id="btnCancel">Cancel</button>
    <button class="btn btn-primary" onclick="StartDownload()" id="btnDownload">Download ISO</button>
</div>
</body>
</html>
